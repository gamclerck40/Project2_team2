{% load static %}
<link rel="stylesheet" href="{% static 'base/css/header.css' %}">

<header class="site-header">
  <h1 class="header-logo">
    <a href="{% url 'product_list' %}" class="logo-link">
      <img src="/static/thumbnail/thumbnail_logo.png" alt="Life Balance" class="logo-img">
    </a>
  </h1>

  <nav class="header-nav">
    <a href="{% url 'product_list' %}" class="nav-link">ìƒí’ˆëª©ë¡</a>
    <a href="/admin/" class="nav-link">ê´€ë¦¬ì</a>

    {% if user.is_authenticated %}
      <a href="{% url 'cart_list' %}" class="nav-link">ğŸ›’ ì¥ë°”êµ¬ë‹ˆ</a>

      <div class="view-toggle-container">
        <span class="toggle-label">ì¼ë°˜</span>
        <label class="switch">
          <input id="shop-view-toggle" type="checkbox" {% if '/shop/consulting' in request.path %}checked{% endif %}>
          <span class="slider"></span>
          <span id="shop-view-knob" class="knob"></span>
        </label>
        <span class="toggle-label active">ì»¨ì„¤íŒ…</span>
      </div>
    {% endif %}

    <span class="v-divider"></span>

    {% if user.is_authenticated %}
      <span class="user-greeting">ì•ˆë…•í•˜ì„¸ìš”, <b>{{ user.username }}</b>ë‹˜</span>

      <div class="header-nav">
        <form method="post" action="{% url 'logout' %}" class="header-logout-form">
          {% csrf_token %}
          <button type="submit" class="btn-header">ë¡œê·¸ì•„ì›ƒ</button>
        </form>
        <a href="{% url 'register_coupon' %}" class="btn-header btn-coupon">ğŸŸï¸ ì¿ í°ë“±ë¡</a>
        <a href="{% url 'transaction_history' %}" class="btn-header">ê±°ë˜ ë‚´ì—­</a>
        <a href="{% url 'mypage' %}" class="btn-header">ë‚´ ì •ë³´</a>
      </div>
    {% else %}
      <div class="header-nav">
        <a href="{% url 'login' %}" class="btn-header">ë¡œê·¸ì¸</a>
        <a href="{% url 'account_signup' %}" class="btn-header btn-signup">íšŒì›ê°€ì…</a>
      </div>
    {% endif %}
  </nav>

  <script>
    (function () {
      const toggle = document.getElementById("shop-view-toggle");
      const knob = document.getElementById("shop-view-knob");
      if (!toggle || !knob) return;

      function syncKnob() {
        knob.style.transform = toggle.checked ? "translateX(20px)" : "translateX(0)";
      }
      syncKnob();

      toggle.addEventListener("change", function () {
        const targetUrl = toggle.checked ? "{% url 'product_consulting_list' %}" : "{% url 'product_list' %}";
        document.body.classList.toggle("consulting-mode", toggle.checked);
        setTimeout(() => { window.location.href = targetUrl; }, 220);
      });
    })();
  </script>
</header>
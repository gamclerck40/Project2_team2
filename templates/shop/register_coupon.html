{% extends "base.html" %}
{% load humanize %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'shop/css/coupon.css' %}">
{% endblock %}

{% block content %}
<div class="coupon-page-container">

    <div class="coupon-reg-section">
        <h2 class="coupon-reg-title">ğŸŸï¸ ì¿ í° ë“±ë¡</h2>
        <form method="post" action="{% url 'register_coupon' %}" class="coupon-reg-form">
            {% csrf_token %}
            <input type="text" name="coupon_code" placeholder="ì¿ í° ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”" required class="coupon-reg-input">
            <button type="submit" class="coupon-reg-btn">ë“±ë¡</button>
        </form>
    </div>

    <div class="coupon-list-section">
        <h3 class="coupon-list-title">ë‚˜ì˜ ì¿ í° ëª©ë¡</h3>

        <div class="coupon-grid">
            {% for uc in user_coupons %}
            <div class="coupon-ticket {% if uc.is_used %}used{% endif %}">

                <div class="coupon-ticket-left">
                    <div class="discount-box">
                        <span class="discount-text">
                            {% if uc.coupon.discount_type == 'amount' %}
                                {{ uc.coupon.discount_value|floatformat:0 }}ì›
                            {% else %}
                                {{ uc.coupon.discount_value|floatformat:0 }}%
                            {% endif %}
                        </span>
                    </div>

                    <div>
                        <div class="coupon-info-name">{{ uc.coupon.name }}</div>
                        <div class="coupon-info-min">ìµœì†Œ ì£¼ë¬¸: {{ uc.coupon.min_purchase_amount|floatformat:0 }}ì›</div>
                    </div>
                </div>

                <div class="coupon-status-box">
                    <div>
                        {% if uc.is_used %}
                            <span class="status-badge status-used">ì‚¬ìš©ì™„ë£Œ</span>
                        {% else %}
                            <span class="status-badge status-available">ì‚¬ìš©ê°€ëŠ¥</span>
                        {% endif %}
                    </div>
                    <div class="coupon-expiry">{{ uc.coupon.valid_to|date:"Y-m-d" }}ê¹Œì§€</div>
                </div>

                <div class="punch-hole punch-l"></div>
                <div class="punch-hole punch-r"></div>
            </div>
            {% empty %}
            <div class="empty-msg">ë³´ìœ í•˜ì‹  ì¿ í°ì´ ì—†ìŠµë‹ˆë‹¤.</div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}